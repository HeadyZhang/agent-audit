# Oracle Ground Truth for KNOWN-003
# MCP Overpermissive Configuration (common pattern)
# Agent-Vuln-Bench v1.0

metadata:
  sample_id: "KNOWN-003"
  source: "MCP Config Pattern"
  commit: "n/a"
  language: "json"
  provenance: "cve"
  license: "MIT"
  date_collected: "2026-02-04"
  cve_ref: "general_mcp_pattern"
  note: "Common misconfiguration pattern observed in Claude Desktop MCP configs"

taxonomy:
  set_class: "B"
  owasp_asi: "ASI-04"
  cwe_id: "CWE-732"

vulnerabilities:
  - id: "VULN-001"
    file: "mcp_config.json"
    line: 7
    rule_expected: "AGENT-029"
    severity: "CRITICAL"
    description: "MCP filesystem server configured with root access (allowedDirectories: /)"
    taint:
      source:
        type: "config"
        location: "mcp_config.json:7"
        code: "\"allowedDirectories\": [\"/\"]"
      sink:
        type: "privilege_grant"
        location: "mcp_config.json:7"
        code: "MCP filesystem server initialization with root access"
      sanitizer: null
    impact:
      primary: "DataExfiltration"
      secondary:
        - "FileDeletion"
        - "PrivilegeEscalation"
      blast_radius: "full_system"

  - id: "VULN-002"
    file: "mcp_config.json"
    line: 14
    rule_expected: "AGENT-004"
    severity: "HIGH"
    description: "Hardcoded database credentials in MCP config"
    taint:
      source:
        type: "string_literal"
        location: "mcp_config.json:14"
        code: "\"connectionString\": \"postgres://admin:password123@localhost:5432/production\""
      sink:
        type: "credential_usage"
        location: "mcp_config.json:14"
        code: "MCP postgres server initialization"
      sanitizer: null
    impact:
      primary: "CredentialExposure"
      secondary:
        - "DataExfiltration"
      blast_radius: "service"

  - id: "VULN-003"
    file: "mcp_config.json"
    line: 20
    rule_expected: "AGENT-031"
    severity: "CRITICAL"
    description: "MCP shell server allows all commands (allowedCommands: *)"
    taint:
      source:
        type: "config"
        location: "mcp_config.json:20"
        code: "\"allowedCommands\": [\"*\"]"
      sink:
        type: "command_execution"
        location: "mcp_config.json:20"
        code: "MCP shell server with unrestricted command access"
      sanitizer: null
    impact:
      primary: "RCE"
      secondary:
        - "PrivilegeEscalation"
        - "DataExfiltration"
      blast_radius: "full_system"

safe_patterns:
  - id: "SAFE-001"
    file: "mcp_config.json"
    line: 3
    code: "\"command\": \"npx\""
    description: "NPX command to launch MCP server — standard pattern"
    trap_type: "standard_command"

  - id: "SAFE-002"
    file: "mcp_config.json"
    line: 4
    code: "\"args\": [\"-y\", \"@anthropic/mcp-server-filesystem\"]"
    description: "Official Anthropic MCP server package — trusted source"
    trap_type: "trusted_package"
