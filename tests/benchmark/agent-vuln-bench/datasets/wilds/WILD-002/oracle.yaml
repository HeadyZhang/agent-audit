# Oracle Ground Truth for WILD-002
# Web Fetcher Tool with SSRF vulnerability
# Agent-Vuln-Bench v1.0

metadata:
  sample_id: "WILD-002"
  source: "GitHub agent web tool pattern"
  commit: "n/a"
  language: "python"
  provenance: "wild"
  license: "MIT"
  date_collected: "2026-02-04"
  collection_method: "Pattern extraction from agent browsing implementations"
  note: "Common pattern in research agents and RAG applications"

taxonomy:
  set_class: "A"
  owasp_asi: "ASI-02"
  cwe_id: "CWE-918"

vulnerabilities:
  # VULN-001 and VULN-002 (SSRF via requests) are detection gaps - not currently detected
  # These would require AGENT-037 (SSRF detection) to be enhanced for tool contexts
  # For now, we track the detectable vulnerability:

  - id: "VULN-003"
    file: "web_fetcher_tool.py"
    line: 130
    rule_expected: "AGENT-001"
    severity: "CRITICAL"
    description: "Command injection via curl command arguments - detected as shell=True subprocess"
    taint:
      source:
        type: "llm_output"
        location: "web_fetcher_tool.py:121"
        code: "def execute_curl(curl_command: str) -> str:"
      sink:
        type: "shell_execution"
        location: "web_fetcher_tool.py:130"
        code: "subprocess.run(f\"curl {curl_command}\", shell=True, ...)"
      sanitizer: null
    impact:
      primary: "RCE"
      secondary:
        - "DataExfiltration"
      blast_radius: "full_system"

  - id: "VULN-003b"
    file: "web_fetcher_tool.py"
    line: 130
    rule_expected: "AGENT-035"
    severity: "CRITICAL"
    description: "Tool with unrestricted code execution (subprocess with shell=True)"
    taint:
      source:
        type: "llm_output"
        location: "web_fetcher_tool.py:121"
        code: "def execute_curl(curl_command: str) -> str:"
      sink:
        type: "shell_execution"
        location: "web_fetcher_tool.py:130"
        code: "subprocess.run(f\"curl {curl_command}\", shell=True, ...)"
      sanitizer: null
    impact:
      primary: "RCE"
      blast_radius: "full_system"

  - id: "VULN-003c"
    file: "web_fetcher_tool.py"
    line: 121
    rule_expected: "AGENT-034"
    severity: "HIGH"
    description: "Tool function without input validation"
    taint:
      source:
        type: "llm_output"
        location: "web_fetcher_tool.py:121"
        code: "def execute_curl(curl_command: str) -> str:"
      sink:
        type: "shell_execution"
        location: "web_fetcher_tool.py:130"
        code: "subprocess.run(...)"
      sanitizer: null
    impact:
      primary: "RCE"
      blast_radius: "full_system"

safe_patterns:
  - id: "SAFE-001"
    file: "web_fetcher_tool.py"
    line: 17
    code: "class MockResponse:"
    description: "Mock class for testing — not a vulnerability"
    trap_type: "test_mock"

  - id: "SAFE-002"
    file: "web_fetcher_tool.py"
    line: 7
    code: "from urllib.parse import urlparse"
    description: "URL parsing import — could be used for validation but isn't"
    trap_type: "unused_safe_import"
