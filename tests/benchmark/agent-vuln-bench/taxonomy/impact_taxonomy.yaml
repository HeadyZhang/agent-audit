# Impact Taxonomy for Agent-Vuln-Bench
# Consequence classification following security impact categories
# Version: 1.0 | Date: 2026-02-04

version: "1.0"

impacts:
  RCE:
    severity: "CRITICAL"
    description: "Remote/Local Code Execution â€” attacker runs arbitrary code"
    examples:
      - "eval(user_input)"
      - "exec(llm_output)"
      - "os.system(cmd)"
      - "subprocess.run(shell=True)"
    related_cwe:
      - "CWE-94"   # Improper Control of Generation of Code
      - "CWE-95"   # Improper Neutralization of Directives in Dynamically Evaluated Code
      - "CWE-78"   # Improper Neutralization of Special Elements used in an OS Command

  DataExfiltration:
    severity: "HIGH"
    description: "Unauthorized data extraction"
    examples:
      - "Read /etc/passwd"
      - "Send user data to external URL"
      - "Access database without auth"
      - "Dump memory/context to attacker"
    related_cwe:
      - "CWE-200"  # Exposure of Sensitive Information
      - "CWE-359"  # Exposure of Private Personal Information
      - "CWE-532"  # Insertion of Sensitive Information into Log File

  PrivilegeEscalation:
    severity: "CRITICAL"
    description: "Gain higher privileges than intended"
    examples:
      - "NOPASSWD sudoers"
      - "daemon with root"
      - "container escape"
      - "bypass role-based access"
    related_cwe:
      - "CWE-269"  # Improper Privilege Management
      - "CWE-250"  # Execution with Unnecessary Privileges
      - "CWE-266"  # Incorrect Privilege Assignment

  CredentialExposure:
    severity: "HIGH"
    description: "Secrets exposed in code, logs, or output"
    examples:
      - "Hardcoded API key"
      - "Password in log output"
      - "Token in error message"
      - "Secrets in source control"
    related_cwe:
      - "CWE-798"  # Use of Hard-coded Credentials
      - "CWE-312"  # Cleartext Storage of Sensitive Information
      - "CWE-319"  # Cleartext Transmission of Sensitive Information

  FileDeletion:
    severity: "HIGH"
    description: "Unauthorized file modification or deletion"
    examples:
      - "rm -rf from agent action"
      - "overwrite config files"
      - "delete user data"
      - "corrupt database files"
    related_cwe:
      - "CWE-73"   # External Control of File Name or Path
      - "CWE-22"   # Improper Limitation of a Pathname to a Restricted Directory
      - "CWE-434"  # Unrestricted Upload of File with Dangerous Type

  DoS:
    severity: "MEDIUM"
    description: "Service disruption or resource exhaustion"
    examples:
      - "Infinite agent loop"
      - "unbounded iterations"
      - "memory exhaustion"
      - "fork bomb"
    related_cwe:
      - "CWE-400"  # Uncontrolled Resource Consumption
      - "CWE-835"  # Loop with Unreachable Exit Condition
      - "CWE-674"  # Uncontrolled Recursion

  FinancialLoss:
    severity: "HIGH"
    description: "Direct financial impact through API abuse"
    examples:
      - "Stolen API key used for inference"
      - "unbounded API calls"
      - "cryptocurrency theft"
      - "fraudulent transactions"
    related_cwe:
      - "CWE-799"  # Improper Control of Interaction Frequency
      - "CWE-770"  # Allocation of Resources Without Limits or Throttling

  DataPoisoning:
    severity: "MEDIUM"
    description: "Corruption of agent memory, training data, or config"
    examples:
      - "Memory injection"
      - "config overwrite"
      - "model weight tampering"
      - "context window pollution"
    related_cwe:
      - "CWE-913"  # Improper Control of Dynamically-Managed Code Resources
      - "CWE-502"  # Deserialization of Untrusted Data

# Severity ordering (for sorting)
severity_order:
  CRITICAL: 1
  HIGH: 2
  MEDIUM: 3
  LOW: 4
  INFO: 5

# Impact to typical Set mapping (for cross-reference)
impact_to_typical_set:
  RCE: "A"
  DataExfiltration: "B"
  PrivilegeEscalation: "C"
  CredentialExposure: "C"
  FileDeletion: "B"
  DoS: "C"
  FinancialLoss: "C"
  DataPoisoning: "B"
